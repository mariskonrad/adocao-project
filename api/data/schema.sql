DROP TABLE IF EXISTS pet CASCADE;
DROP TABLE IF EXISTS comment CASCADE;
DROP TABLE IF EXISTS event CASCADE;
DROP TABLE IF EXISTS username CASCADE;
DROP TABLE IF EXISTS permission CASCADE;

CREATE TABLE username (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	name VARCHAR(255) NOT NULL,
	email VARCHAR(255) NOT NULL,
	password VARCHAR(512) NOT NULL,
	active BOOLEAN NOT NULL
);

ALTER TABLE username ADD CONSTRAINT pk_username PRIMARY KEY (id);
ALTER TABLE username ADD CONSTRAINT uk_email UNIQUE (email);

CREATE TABLE permission (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	role VARCHAR(100) NOT NULL,
	user_id BIGINT NOT NULL
);

ALTER TABLE permission ADD CONSTRAINT pk_permission PRIMARY KEY(id);
ALTER TABLE permission ADD CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES username;

CREATE TABLE pet (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	name VARCHAR(100) NOT NULL,
	age INT NOT NULL,
	size VARCHAR(6) NOT NULL,
	sex CHAR(1) NOT NULL,
	breed VARCHAR(150) NOT NULL,
	image VARCHAR(512) NOT NULL,
	available BOOLEAN NOT NULL
);

ALTER TABLE pet ADD CONSTRAINT pk_pet PRIMARY KEY (id);

CREATE TABLE comment (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	pet_id BIGINT NOT NULL,
	text VARCHAR(512) NOT NULL
);

ALTER TABLE comment ADD CONSTRAINT pk_comment PRIMARY KEY (id);
ALTER TABLE comment ADD CONSTRAINT fk_comment FOREIGN KEY (pet_id) REFERENCES pet;

CREATE TABLE event (
	id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
	description VARCHAR(1024) NOT NULL,
	start_event TIMESTAMP NOT NULL,
	location VARCHAR(512) NOT NULL,
	image VARCHAR(512) NOT NULL
);

ALTER TABLE event ADD CONSTRAINT pk_event PRIMARY KEY (id);
